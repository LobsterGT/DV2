{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Government Spending On Education",
  "data": {
    "url": "https://raw.githubusercontent.com/LobsterGT/DV2/refs/heads/main/data/share-of-education-in-government-expenditure.csv"
  },
  "width": "container",
  "height": 300,
  "config": {
    "title": {
      "fontSize": 20,
      "font": "Serif"
    }
  },
  "layer":[      
    {
      "transform": [
      {
        "filter": "datum.Entity == 'Malaysia'"
      },
      {"filter": "datum.Year >= 2000 && datum.Year <= 2022"}
    ],
    "mark": {
      "type": "area",
      "interpolate": "monotone"
    },
    "encoding": {
      "x": {
        "field": "Year",
        "type": "ordinal",
        "title": "Year",
        "axis": {
          "grid": true
      }
      },
      "y": {
        "field": "Government_spending",
        "type": "quantitative",
        "title": "Education Share of Gov Spending (%)"
      },
      "tooltip": [
        {"field": "Year", "title": "Year"},
        {"field": "Government_spending", "type": "quantitative", "title": "Education Share of Gov Spending (%)", "format": ",.1f"}
      ]
    }
  },
      {
    "transform": [
      {
        "filter": "datum.Entity == 'Malaysia'"
      },
      {"filter": "datum.Year >= 2000 && datum.Year <= 2022"},
      {
        "aggregate": [
          {"op": "argmax", "field": "Government_spending", "as": "max_spending"}
        ]
      },
      {"calculate": "datum.max_spending['Year']", "as": "maxYear"},
      {"calculate": "datum.max_spending['Government_spending']", "as": "maxSpending"},
      {
        "calculate": "'Highest Spending: ' + format(datum.maxSpending, ',.1f') + '%'",
        "as": "label"
      }
    ],
      "mark": {
        "type": "text",
        "align": "center",
        "baseline": "bottom",
        "dy": -5,
        "color": "black"
      },
      "encoding": {
        "x": {"field": "maxYear", "type": "ordinal"},
        "y": {"field": "maxSpending", "type": "quantitative"},
        "text": {"field": "label", "type": "nominal"}
      }
  },
      {
    "transform": [
      {
        "filter": "datum.Entity == 'Malaysia'"
      },
      {"filter": "datum.Year >= 2000 && datum.Year <= 2022"},
      {
        "aggregate": [
          {"op": "argmax", "field": "Government_spending", "as": "max_spending"}
        ]
      },
      {"calculate": "datum.max_spending['Year']", "as": "maxYear"},
      {"calculate": "datum.max_spending['Government_spending']", "as": "maxSpending"}
    ],
    "mark": {
      "type": "point",
      "filled": true,
      "size": 80,
      "color": "red"
    },
    "encoding": {
      "x": {"field": "maxYear", "type": "ordinal"},
      "y": {"field": "maxSpending", "type": "quantitative"}
    }
  }
]
}
